<!DOCTYPE html>
<html>
<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>ProfitPro</title>

  <!-- bootstrap core css -->
    <!--Find out why this is not working-->
  <link rel="stylesheet" type="text/css" href="/index-css/bootstrap.css" />
  <link rel="stylesheet" type="text/css" href="adminPage_user_table.css" />

  <!-- fonts style -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet" />
  <!-- Custom styles for this template -->
  <link href="index-css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="index-css/responsive.css" rel="stylesheet" />
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
</head>






  <!--Beginning of Page content-->
<body>




  <div class="hero_area">
    <!-- header section starts -->
    <header class="header_section">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="index.html">
            <span>
              ProfitPro
            </span>
          </a>

            <button id="openCalendar" type='button' style="margin-left: 20px;">üìÖ</button>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

            <!--Nav Bar creation-->

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <div class="d-flex ml-auto flex-column flex-lg-row align-items-center">
              <ul class="navbar-nav  ">
                <li class="nav-item">
                    <!--Need a home-->
                  <a class="nav-link" href="index.html">Home </a>
                </li>
                <li class="nav-item ">
                  <a class="nav-link" href="bookkeeping.html"> Bookkeeping </a>
                </li>
                <li class="nav-item active">
                  <a class="nav-link" href="reports.html"> Reports </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">
                    <span>User Settings</span> 
                  </a>
                </li>
                <li class="nav-item">
                  <!--Change later to only appear if user's account is
                    a Manager type-->
                  <a class="nav-link" href="adminPage.html"> Administrator <span class="sr-only">(current)</span></a>
                </li>
                  <!--Change later to only appear if user's account is
                    a Admin type-->
                <li class="nav-item">
                    <!--Change to be able to click on UsersName and change settings-->
                    <a class="nav-link" href="#" id='adminPage-userName'> JTonnesen-09-24<!--User Name--></a>
                </li>
               </ul>
              <div class="user_option">
                <form class="form-inline my-2 my-lg-0 ml-0 ml-lg-4 mb-3 mb-lg-0">
                  <button class="btn  my-2 my-sm-0 nav_search-btn" type="submit"></button>
                </form>
              </div>
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- end header section -->

<div id='overlay' style="display: none;">
  <style>
      .calendar * { margin: 0; padding: 0; font-family: 'Poppins', sans-serif; }
      .calendar body { display: flex; background: #ef62da; min-height: 100vh; padding: 0 10px; align-items: center; justify-content: center; }
      .calendar-container { background: #fff; width: 450px; border-radius: 10px; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12); }
      .calendar-container header { display: flex; align-items: center; padding: 25px 30px 10px; justify-content: space-between; }
      header .calendar-navigation { display: flex; }
      header .calendar-navigation span { height: 38px; width: 38px; margin: 0 1px; cursor: pointer; text-align: center; line-height: 38px; border-radius: 50%; user-select: none; color: #aeabab; font-size: 1.9rem; }
      .calendar-navigation span:last-child { margin-right: -10px; }
      header .calendar-navigation span:hover { background: #f2f2f2; }
      header .calendar-current-date { font-weight: 500; font-size: 1.45rem; }
      .calendar-body { padding: 20px; }
      .calendar-body ul { list-style: none; flex-wrap: wrap; display: flex; text-align: center; }
      .calendar-body .calendar-dates { margin-bottom: 20px; }
      .calendar-body li { width: calc(100% / 7); font-size: 1.07rem; color: #414141; }
      .calendar-body .calendar-weekdays li { cursor: default; font-weight: 500; }
      .calendar-body .calendar-dates li { margin-top: 30px; position: relative; z-index: 1; cursor: pointer; }
      .calendar-dates li.inactive { color: #aaa; }
      .calendar-dates li.active { color: #fff; }
      .calendar-dates li::before { position: absolute; content: ""; z-index: -1; top: 50%; left: 50%; width: 40px; height: 40px; border-radius: 50%; transform: translate(-50%, -50%); }
      .calendar-dates li.active::before { background: #6332c5; }
      .calendar-dates li:not(.active):hover::before { background: #e4e1e1; }
      #overlay {position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent background */ z-index: 999; /* On top of other elements */ display: flex; /* Use flexbox to center contents */ align-items: center; /* Vertically center */ justify-content: center; /* Horizontally center */ }
      #calendar {width: auto;top: 50%; left: 50%; border-radius: 10px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); z-index: 1000; /* On top of the overlay */ padding: 20px; }
    </style>


        <div id="calendar" style="display: block; right: 50%; position: relative; top: 40%; left: 50%; transform: translate(-50%, -50%); padding: 20px; border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 8px; z-index: 1000;">              <div class="calendar-container">
          <header class="calendar-header">
            <button id='closeCalendar' class="calendar-container" style="width:auto;cursor: pointer;background-color: transparent;border: 0px solid #3498db;">‚ùå</button>
                  <p class="calendar-current-date"></p>
                  <div class="calendar-navigation">
                    <span id="calendar-prev"
                      class="material-symbols-rounded">
                      chevron_left
                    </span>
                    <span id="calendar-next"
                      class="material-symbols-rounded">
                      chevron_right
                    </span>
                  </div>
                </header>

                <div class="calendar-body">
                  <ul class="calendar-weekdays">
                    <li>Sun</li>
                    <li>Mon</li>
                    <li>Tue</li>
                    <li>Wed</li>
                    <li>Thu</li>
                    <li>Fri</li>
                    <li>Sat</li>
                  </ul>
                  <ul class="calendar-dates"></ul>
                </div>
              </div>

            </div>
        </div>



      <!--Styling for website theme-->
    <style>
           body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; }
           header { background: blue; color: #ffffff;  text-align: center; }
           nav { margin-bottom: 10px }
           nav a { color: #ffffff; margin: 0 15px; text-decoration: none; }
           .container { width: 80%; margin: auto; overflow: hidden; }
           footer { background: blue; color: #ffffff; text-align: center; padding: 10px 0; position: relative; bottom: 0; width: 100%; }
           .administratorsection { display: flex; justify-content: space-around; margin: 20px 0; }
           .tab { overflow: hidden; border: 1px solid #ccc; background-color: #f1f1f1; }
           .tab button { background-color: inherit; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; }
           .tab button:hover { background-color: #ddd; }
           .tab button.active { background-color: #ccc; }
           .tabcontent { display: none; padding: 6px 12px; border: 1px solid #ccc; border-top: none; background-color: #f1f1f1; }
           fieldset { margin-bottom: 30px; }
           input { height: auto; display: block; width: 20%; margin: 5px; }
           input[id="bodyEmail"]{ width: 75%; padding: 60px; }
           tr { border-bottom: 1px solid black; width: 100%; }
           td { text-align: center; }
           table { width: 100%; }

       </style>

      <!--Styling for Clint's HTML-->
        <style>
            :root { --primary-color: #3498db; --secondary-color: #2c3e50; --background-color: #ecf0f1; --text-color: #34495e; --border-color: #bdc3c7; }
            .caf body { font-family: 'Arial', sans-serif; line-height: 1.6; color: var(--text-color); background-color: var(--background-color); margin: 0; padding: 20px; }
            .ca-container { max-width: 1000px; margin: 0 auto; background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
            .caf h1, h2 { color: var(--secondary-color); margin-bottom: 20px; }
            .caf form { display: grid; gap: 15px; margin-bottom: 30px; }
            .caf label { font-weight: bold; }
            .caf input, select, textarea { width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; font-size: 14px; }
            .caf button { background-color: var(--primary-color); color: white; border: none; padding: 10px 15px; border-radius: 4px; cursor: pointer; font-size: 16px; transition: background-color 0.3s; width: 100%; }
            .caf button:hover { background-color: #2980b9; }
            .caf table { width: 100%; border-collapse: collapse; margin-top: 20px; background-color: white; }
            .caf th, td { border: 1px solid var(--border-color); padding: 12px; text-align: left; }
            .caf th { background-color: var(--primary-color); color: white; }
            #delete_Tables .caf th { background-color: red; color: white; }
            #accountsTable tbody tr:hover { background-color: #f5f5f5; cursor: pointer; }
            #eventLogTable tbody tr:hover { background-color: #f5f5f5; cursor: pointer; }
            #delete_Tables tbody tr:hover { background-color: #f5f5f5; cursor: pointer; }
            /*#journalEntries tbody tr:hover { background-color: #f5f5f5; cursor: pointer; }*/


            #ledgerView { display: none; margin-top: 30px; background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
            #ledgerTitle { color: var(--primary-color); margin-bottom: 15px; }

            #EventLogView { display: none; margin-top: 30px; background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
            #EventLogTitleTitle { color: var(--primary-color); margin-bottom: 15px; }

            #journalEntries { display: none; margin-top: 30px; background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
            #journalEntryTitle { color: var(--primary-color); margin-bottom: 15px; }


          /*Transition Effects*/

            .hidden { opacity: 0; visibility: hidden; transition: opacity 0.5s ease-out, visibility 0.5s ease-out; }

            .visible { opacity: 1; visibility: visible; transition: opacity 0.5s ease-in, visibility 0.5s ease-in; }



        </style> 
      <!--Auto open first tabe script, set all others to inactive-->

       <script>
         document.addEventListener("DOMContentLoaded", function() {
           document.getElementById("defaultOpen").click();
         });
           function openTab(evt, cityName) {
               var i, tabcontent, tablinks;
               tabcontent = document.getElementsByClassName("tabcontent");
               for (i = 0; i < tabcontent.length; i++) {
                   tabcontent[i].style.display = "none";
               }

               tablinks = document.getElementsByClassName("tablinks");
               for (i = 0; i < tablinks.length; i++) {
                   tablinks[i].className = tablinks[i].className.replace(" active", "");
               }

               document.getElementById(cityName).style.display = "block";
               evt.currentTarget.className += " active";
           }
       </script>



<!--Nav bar for the bookkeeping page	-->
    <div class="container">
           <section id="bookkeepersection">
               <h2>Chart of Accounts</h2>
               <div class="services">
                   <div class="tab">
                       <!--<button class="tablinks" onclick="openTab(event, 'Account')" id="defaultOpen">Create Account</button>-->
                       <button class="tablinks" onclick="openTab(event, 'Modify_Account')" id="defaultOpen">Accounts</button>
                       <button class="tablinks" onclick="openTab(event, 'Email')">Email</button>
                       <button class="tablinks" onclick="goToReports();">Create Reports</button>
                   </div>


            <script>
            function goToReports(){
              window.open("trialbalance.html", "_blank");
            }



            </script>






<!--Styling and divs for Users management page on AdminPage-->
  <div id="Account" class="tabcontent">
    <div id="mainContainer-accountCreation">

    </div>

<!--End of Manage users Tab-->
  </div> 
</div>


  <!--Update with table from adminPage-->
  <div id="Modify_Account" class="tabcontent">


    <div id="mainContainer-accountLedger">


    <div id='COA_Tables'>

    <!--Needs implementation-->
      <h2 id='coa_title'>Select an Account</h2>

                <div id='search' class='visible'>

                  <style>
                  body {
                    font-family: Arial, sans-serif;
                    line-height: 1.6;
                    padding: 20px;
                    background-color: #f4f4f4;
                  }
                  #searchBar {
                    width: 100%;
                    padding: 10px;
                    margin-bottom: 20px;
                    font-size: 16px;
                  }
                  table {
                    width: 100%;
                    border-collapse: collapse;
                    background-color: #fff;
                  }
                  th, td {
                    padding: 12px;
                    text-align: left;
                    border-bottom: 1px solid #ddd;
                  }
                  th {
                    background-color: #f2f2f2;
                  }
                  tr: hover {
                    background-color: #f5f5f5;
                    cursor: pointer;
                  }
                  .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgba(0,0,0,0.4);
                  }
                  .modal-content {
                    background-color: #fefefe;
                    margin: 15% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                    max-width: 600px;
                  }
                  .close {
                    color: #aaa;
                    float: right;
                    font-size: 28px;
                    font-weight: bold;
                  }
                  .close:hover,
                  .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                  }
                  </style>



                  <input type="text" id="searchBar" placeholder="Search for accounts...">


                  <div id="accountModal" class="modal">
                    <div class="modal-content">
                      <span class="close">&times;</span>
                      <h2>Account Details</h2>
                      <p id="accountDetails"></p>
                    </div>
                  </div>

                </div>


          <!--***************************-->
              <!--Report for Account in COA-->
          <!--***************************-->

        <div id='button-list-div' class='hidden' style='text-align: right; display: none; padding: 10px;'>
          <span style='display: inline; padding:10px;'>
            <button id="deSelectAccount" style="border-radius: 25px; color: white; background-color: grey;">Back</button>
          </span>
        </div>



      <table id="accountsTable" class='caf'>
        <thead class='caf'>
          <tr class='caf'>
            <th class='caf'>Account Number</th>
            <th class='caf'>Account Name</th>
            <th class='caf'>Description</th>
            <th class='caf'>Normal Side</th>
            <th class='caf'>Category</th>
            <th class='caf'>Subcategory</th>
          </tr>
        </thead>
        <tbody id='coa_table'class='caf'>

          <!-- Accounts will be added here dynamically -->
        </tbody>
      </table>
    </div>



              <!--***************************-->
              <!--Journal Entry Style for PostRef -->
              <!--***************************-->
              <style>
              @keyframes highlight {
              0% {
                background: grey;
              }
              100% {
                background: none;
              }
              }

              .highlight {animation: highlight 3s;}

              </style>



              <!--######################### #########################-->
              <!--Script for Post Reference highlighting and directing-->
              <!--######################### #########################-->

              <script>


              //Need to implement Script where you add class then direct to link within the site

              function directTo(destination){

                window.location = `#${destination}`; 

                document.getElementById(destination).classList.add("highlight");
                setTimeout(() => { document.getElementById(destination).classList.remove("highlight");}, 3000);
              }

              </script>





        <div id="ledgerView" class='hidden'>
            <h2>Account Ledger</h2>
            <h3 id="ledgerTitle"></h3>
            <table id="ledgerTable" class='caf'>
                <thead class='caf'>
                    <tr class='caf'>
                        <th class='caf'>Post Reference</th>
                        <th class='caf'>Date</th>
                        <th class='caf'>Description</th>
                        <th class='caf'>Debit</th>
                        <th class='caf'>Credit</th>
                        <th class='caf'>Balance</th>
                    </tr>
                </thead>
                <tbody id='ledger-table'>
                    <!-- Ledger entries will be added here dynamically -->
                </tbody>
            </table>
        </div>


          <!--***************************-->
              <!--Journal Entry Table -->
          <!--***************************-->



      <div id="journalEntries" class='hidden' style='display: none;'>
        <h2>Journal Entries</h2>

          <div id='journal-button-list-div' class='hidden' style='display: none; display: flex; justify-content: space-between; margin-bottom: 20px;'>
                  <select id="statusFilter" style="width:  150px;">
                    <option value="all">All</option>
                    <option value="pending">Pending Approval</option>
                    <option value="approved">Approved</option>
                    <option value="denied">Denied</option>
                  </select>
                  <input type="text" id="searchInput" placeholder="Search...">
                  <input type="date" id="dateFilter">
                  <span style="display: inline; padding:10px;">
                    <button id="journal-createJEEntry" onclick="showJE_Form()" style="border-radius: 25px; color: white; background-color: green;">Create Journal Entry</button>
                  </span>
          </div>

                <script>
                function showJE_Form(){
                  document.getElementById("journalEntryFormDiv").classList.remove("hidden");
                  document.getElementById("journalEntryFormDiv").classList.add("visible");
                  setTimeout(() => {
                    document.getElementById("journalEntryFormDiv").style.display = "block";
                  }, 500);
                }
                </script>



        <table id="journalEntriesTable" class='caf' style='text-align: center'>
          <thead class='caf'>
            <tr class='caf'>
              <th class='caf'>Date</th>
              <th class='caf'>Description</th>
              <th class='caf'>Debits</th>
              <th class='caf'>Credits</th>
              <th class='caf'>Balance</th>
              <th class='caf'>Comments</th>
              <th class='caf'>Status</th>
              <th class='caf'>Actions</th>
            </tr>
          </thead>
          <tbody id='journal-table'class='caf'>
                    <!--<tr>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>Test</td>-->
                    <!--  <td>-->
                    <!--    <span style="display: flex; margin-right: 10px;">-->
                    <!--      <button style="border-radius: 25px; background-color: green;">Approve</button>-->
                    <!--      <button style="border-radius: 25px; background-color: red;">Deny</button>-->
                    <!--    </span>-->
                    <!--  </td>-->
                    <!--</tr>-->
                    <!---->
            <!-- Accounts will be added here dynamically -->
          </tbody>
        </table>


      </div>
    </div>


          <!--***************************-->
              <!--Journal Entry Form -->
          <!--***************************-->

      <div id="journalEntryFormDiv" class='hidden' style='display: none;'>

              <br>
              <hr>

        <h2>Create a Entry</h2>

              <div class="container" style='width: auto;'>

          <form id="journalEntryForm" action="http://localhost:5001/profitpro-e81ab/us-central1/createJournalEntry" style="display: flex; flex-direction: column; gap: 15px; padding: 20px; border: 1px solid #ccc; border-radius: 8px; background-color: #f9f9f9;">

            <input type="hidden" id='coa-ledger-source' name='source' value="" style='display:none'>

            <div style="display: flex; gap: 15px; align-items: center; width:100%;/*! margin-left: ; */">
              <div>
                <label for="ledger-date" style="display: block; margin-bottom: 5px;">Date:</label>
                <input type="date" id="journal-date" name="dateAdded" required="" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 200px;">
              </div>

            </div>
            <div>
              <label for="ledger-desc" style="display: block; margin-bottom: 5px;">Record Description:</label>
              <textarea id="journal-accountDesc" name="description" required='' rows="3" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;"></textarea>
            </div>


                  <!--***********Debit and Credit Entries******************-->
                  <div style="display: flex;text-align: center;">

                    <div style="margin-left: 25%;margin-right: 15px;">
                      <div id="Debits" style="text-align: center">
                      <!--Debit + Credit entries will be added here every click of 'Add Entry' button-->
                    </div>

                    <div style="width: 250px">
                      <button id="addDebitEntryJE" onclick="addDebitEntry('Debits')" type="button" style="color: white; background-color: grey; border: none; border-radius: 4px; padding: 10px 15px; cursor: pointer;">Add Debit</button>
                    </div>
                    </div>


                    <div>
                    <div id="Credits" style="text-align: center;">
                      <!--Debit + Credit entries will be added here every click of 'Add Entry' button-->
                    </div>

                    <div style="text-align: center;width: 250px;">
                      <button id="addCreditEntryJE" onclick="addCreditEntry('Credits')" type="button" style="color: white; background-color: grey; border: none; border-radius: 4px; padding: 10px 15px; cursor: pointer;">Add Credit</button>
                    </div>
                    </div>
                  </div>


              <div>
                <label for="ledger-file" style="display: block; margin-bottom: 5px;">Attach File:</label>
                <input type="file" accept='.pdf, .docx, .csv, .jpg, .png, .xls' id="ledger-file" name="ledgerFile" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;">
              </div>


            <span style="display: inline; text-align: center;">
              <button type="submit" style="color: white; background-color: green; border: none; border-radius: 4px; padding: 10px 15px; cursor: pointer;">Submit</button>
              <button type="button" onclick='hideJE_Form()' style="color: white; background-color: red; border: none; border-radius: 4px; padding: 10px 15px; cursor: pointer;">√ó Cancel</button>
            </span>
          </form>
              </div>




          <!--***************************-->
              <!--Scripts for Journal Entry Section-->
          <!--***************************-->

    <script>

              //****Created by Erik*****

              let debitCount = 0;

              function addDebitEntry(divId){
                const entryDiv = document.getElementById(divId);

                const newEntryDiv = document.createElement('div'); 
                newEntryDiv.id = `DebitDiv-${debitCount}`;

                const input = document.createElement('input');

                input.style.display =  "inline";
                input.style.width = "200px";

                input.required = "";
                input.type = 'number';
                input.step = '0.01';
                input.required = true;
                input.name = `Debit-${debitCount}`;

                const removeButton = document.createElement('span');
                removeButton.textContent = '‚ùå';
                removeButton.style.cursor = "pointer";
                removeButton.style.color = "red";

                removeButton.onclick = function() {
                  console.log(newEntryDiv);
                    entryDiv.removeChild(newEntryDiv);
                };


                newEntryDiv.appendChild(input);
                newEntryDiv.appendChild(removeButton);

                entryDiv.appendChild(newEntryDiv);
                
                debitCount++;


              }

              let creditCount = 0;

              function addCreditEntry(divId){
                const entryDiv = document.getElementById(divId);
                const newEntryDiv = document.createElement('div'); 
                  
                newEntryDiv.id = `Credit-${creditCount}`;

                const input = document.createElement('input');

                input.style.display = "inline";
                input.style.width = "200px";

                input.required = "";
                input.type = 'number';
                input.step = '0.01';
                input.required = true;
                input.name = `Credit-${creditCount}`;

                const removeButton = document.createElement('span');
                removeButton.textContent = '‚ùå';
                removeButton.style.cursor = "pointer";
                removeButton.style.color = "red";

                removeButton.onclick = function() {
                  console.log(newEntryDiv);
                    entryDiv.removeChild(newEntryDiv);
                };


                newEntryDiv.appendChild(input);
                newEntryDiv.appendChild(removeButton);

                entryDiv.appendChild(newEntryDiv);

                creditCount++;


              }






              let entryCount = 0;

              //*****************Not used but maybe need to in the future**************************
              function addDebitCreditEvent(){

                const entryDiv = document.getElementById('Debits');

                const newTable = document.createElement('table');
                newTable.id = `EntryCount-${entryCount}`;
                newTable.innerHTML = `
                <tbody style="text-align: center;"><tr style="text-align: center;">
                <th style="text-align: center;">Account</th>
                <th style="text-align: center;">Debit</th>
                <th style="text-align: center;">Credit</th>
                  
                </tr>
                <tr style="text-align: center;border-bottom: 100px;">
                <td style="text-align: center;">322-Liability-TestAccount</td>
                <td style="text-align: center;"> 
                    <label for="ledger-debit">Debit Amount:
                      <input type="text" id="ledger-debit" name="debit" required="" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 200px;"></label>
                 </td>
                  <td></td>
                </tr>
                <tr>
                  <td style="text-align: center;">
                    <select name="cars" id="cars">
                      <option value="volvo">Select an Account</option>
                      <option value="volvo">Account 1</option>
                      <option value="saab">Account 2</option>
                      <option value="mercedes">Account 3</option>
                      <option value="audi">Account 4</option>
                    </select> 
                  </td>
                <td></td>
                  <td style="text-align: center;">
                    <label for="ledger-debit">Credit Amount:
                      <input type="text" id="ledger-debit" name="debit" required="" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 200px;"></label>
                  </td>
                   </tr><tr style="background-color: grey;">
                  <td style="text-align: center;"> Balance:</td>
                <td></td>
                <td></td>
                   </tr>
                </tbody>`;


                entryDiv.append(newTable);

                const hr = document.createElement('hr');
                entryDiv.append(hr);

                const br = document.createElement('br');
                entryDiv.append(br);

                entryCount++;

              }

  




                function hideJE_Form(){
                  document.getElementById("journalEntryForm").classList.remove("visible");
                  document.getElementById("journalEntryForm").classList.add("hidden");
                  setTimeout(() => {
                    document.getElementById("journalEntryForm").style.display = "none";
                  }, 500);
                document.getElementById("journalEntryForm").reset();
                }


              //Popup Message controls

              function showPopup() {
                document.getElementById('popupOverlay').style.display = 'block';
              }

              function closePopup() {
                document.getElementById('popupOverlay').style.display = 'none';
                location.reload(); // Refresh the page
              }



              function showErrorPopup() {
                document.getElementById('Error-popupOverlay').style.display = 'block';
              }

              function closeErrorPopup() {
                document.getElementById('Error-popupOverlay').style.display = 'none';
              }




              //****Created by Erik*****

              </script>





              <!--Handle Journal entry form submission-->
              <script>

        let accountBalances = {};

        document.getElementById('journalEntryForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            const entry = {
                source: formData.get('source'),  
                Date: formData.get('dateAdded'),
                Description: formData.get('description'),
                Debits: [],
                Credits: [],
                Status: 'Pending',  // Set initial status to Pending
                Comments: "Awaiting Decision",
                PostReference: "NA"

            };

          let debits =[];
          let credits =[];

            // Collect debits and credits
            const debitDiv = document.getElementById('Debits');
            debitDiv.querySelectorAll('input').forEach(debitEntry => {
                entry.Debits.push({
                    amount: parseFloat(debitEntry.value)
                });
            debits.push(debitEntry.value);
            });

            const creditDiv = document.getElementById('Credits');
            creditDiv.querySelectorAll('input').forEach(creditEntry => {
                entry.Credits.push({
                    amount: parseFloat(creditEntry.value)
                });
            credits.push(creditEntry.value);
            });

            // Validate that debits and credits balance
            const totalDebits = entry.Debits.reduce((sum, debit) => sum + debit.amount, 0);
            const totalCredits = entry.Credits.reduce((sum, credit) => sum + credit.amount, 0);
            if (totalDebits !== totalCredits) {

            document.getElementById("Error-popUpTitle").innerHTML = "Error";
            document.getElementById("Error-popUpTitle").style.color = "#e33030";

            document.getElementById("Error-popUpMessage").innerHTML = `Debits and credits must balance!`;
            document.getElementById("Error-popUpMessage").style.color = "#e33030";

            document.getElementById("Error-overlayButton").style.backgroundColor = "#e33030";
            showErrorPopup();

                return;
            }

                entry.Balance = totalDebits;
          entry.Debits = debits;
          entry.Credits = credits;
          

                JSON.stringify(entry);
                const queryParams = new URLSearchParams(entry).toString();
                const url = `${event.target.action}?${queryParams}`;

                console.log("queryParams: " + queryParams);
                console.log("url: " + url);


              try {

                const API_response = await fetch(url, {
                  method: "GET"
                });

                const result = await API_response.json();
                const message = result.message;

                if (API_response.ok) {
                  document.getElementById("popUpTitle").innerHTML = "Ledger Entry Added";
                  document.getElementById("popUpMessage").innerHTML = `${message}`;
                  showModifyPopup();
                }else{
                  document.getElementById("popUpTitle").innerHTML = "Ledger Entry Denied";
                  document.getElementById("popUpMessage").innerHTML = `${message}`;
                  document.getElementById("overlayButton").style.backgroundColor = "#e33030";
                  showModifyPopup();
                }

              }catch(e){
                console.log(e);
              }


          console.log(debits);
          console.log(credits);

            // Clear the form
            e.target.reset();
        });

        function showModifyPopup() {
          document.getElementById('popupOverlay').style.display = 'block';
        }
        function ErrorshowModifyPopup() {
          document.getElementById('Error-popupOverlay').style.display = 'block';
        }
            


        async function handleApproveDenyForm(event, formId){
          event.preventDefault();

          const form = event.target;
          const formData = new FormData(form);

          const queryParams = new URLSearchParams(formData).toString();

          const url = `${event.target.action}?${queryParams}`;

          try {

            const API_response = await fetch(url, {
              method: "GET"
            });

            const result = await API_response.json();
            const message = result.message;

            if (API_response.ok) {
              document.getElementById("popUpTitle").innerHTML = "Account Status set to Approved";
              document.getElementById("popUpMessage").innerHTML = `${message}`;
              showModifyPopup();
            }else{
              document.getElementById("popUpTitle").innerHTML = "Error";
              document.getElementById("popUpMessage").innerHTML = `${message}`;
              document.getElementById("overlayButton").style.backgroundColor = "#e33030";
              showModifyPopup();
            }

          }catch(e){
            console.log(e);
          }


        }





    </script>


              <!--****************-->
              <!--End Journal Entry portion-->
              <!--****************-->







      </div>


              <!--****************-->
              <!--Popup message div-->
              <!--****************-->

            <div id="popupOverlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.5); z-index: 1;">
              <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 20px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 2; border-radius: 5px; text-align: center;">
                <h2 id="popUpTitle">User Created</h2>
                <p id="popUpMessage">Account has been created for the Chart of Accounts</p>
                <button id="overlayButton" class="close-button" onclick="closePopup()" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Close</button>
              </div>
            </div>


            <div id="Error-popupOverlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.5); z-index: 1;">
              <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 20px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 2; border-radius: 5px; text-align: center;">
                <h2 id="Error-popUpTitle">User Created</h2>
                <p id="Error-popUpMessage">Account has been created for the Chart of Accounts</p>
                <button id="Error-overlayButton" class="close-button" onclick="closeErrorPopup()" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Close</button>
              </div>
            </div>





          <!--***************************-->
              <!--Event Log Table -->
          <!--***************************-->

        <div id="EventLogView" class='hidden'>
            <h2>Event Log</h2>
            <h3 id="EventLogTitle"></h3>
            <table id="eventLogTable" class='caf'>
                <thead class='caf'>
                    <tr class='caf'>
                        <th class='caf'>Event ID</th>
                        <th class='caf'>Type Of Change</th>
                        <th class='caf' style='width: 300px;'>Description</th>
                        <th class='caf'>Date Changed</th>
                        <th class='caf'>Time Changed</th>
                        <th class='caf'>Changed By</th>

                    </tr>
                </thead>
                <tbody id='EventLog-table'>
                    <!-- Ledger entries will be added here dynamically -->
                </tbody>
            </table>
    </div>

          <!--***************************-->
              <!--Before and After Event tables-->
          <!--***************************-->

        <div id="EventLogImagesView" class='hidden' style='display: none;'>
                <br><hr><br>
                <span>
                  <h4 style="display: inline-block;padding-right: 68%;">How the Ledger Changed</h4>
                  <button id="closeBeforeAfter" style="display: inline-block;text-align: right;border-radius: 25px;color: white;background-color: grey;">Close</button>
                </span><br>

                <h3 id="EventLogTitle"></h3>
                <span style="/*! display: inline-flex; */">
                  <div style="width: 48%;display: inline-block;vertical-align: top;margin-right: 20px;text-align: center;">
                    <label style="text-align: center;"> Before</label>
                    <table id="beforeTable" class="caf" style="font-size: 10px;">
                      <thead class="caf">
                        <tr class="caf">
                        <th class='caf'>Date</th>
                        <th class='caf'>Description</th>
                        <th class='caf'>Debit</th>
                        <th class='caf'>Credit</th>
                        <th class='caf'>Balance</th>
                        </tr>
                      </thead>
                      <tbody id="EventLogBefore-table">
                        <!-- Ledger entries will be added here dynamically -->
                      </tbody>
                    </table>

                  </div>
                  <div style="width: 48%;display: inline-block;vertical-align: top;text-align: center;">  <label>After</label>
                    <table id="afterTable" class="caf" style="font-size: 10px;">
                      <thead class="caf">
                        <tr class="caf">
                          <th class='caf'>Date</th>
                          <th class='caf'>Description</th>
                          <th class='caf'>Debit</th>
                          <th class='caf'>Credit</th>
                          <th class='caf'>Balance</th>
                        </tr>
                      </thead>
                      <tbody class="caf" id="EventLogAfter-table">
                        <!-- Ledger entries will be added here dynamically -->
                      </tbody>
                    </table><div></div>
                  </div>
                </span>
                <!--end of before + after image div-->

                </div>



                <!--end of event log div-->
              </div>



      <!--end of ledger page div-->
    </div>

  <!--end of site div-->
  </div>

          <!--***************************-->
              <!--Email Tab and form-->
          <!--***************************-->


  <div id="Email" class="tabcontent">

    <h3>Email</h3>

<!--http://127.0.0.1:5001/profitpro-e81ab/us-central1/sendMail-->
<!--https://sendmail-hbs3oxnkoa-uc.a.run.app/sendMail-->
    <form id='send-Email'
      action="http://127.0.0.1:5001/profitpro-e81ab/us-central1/sendMail" method="GET" style="max-width: 600px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9;">
      <h2 style="text-align: center; color: #333; margin-bottom: 20px;">Send Email</h2>

      <!-- To Field -->
      <label for="to" style="display: block; font-size: 14px; color: #333; margin-bottom: 5px;">To:</label>
      <input type="email" id="to" name="to" required style="width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;">
      <!-- Subject Field -->
      <label for="subject" style="display: block; font-size: 14px; color: #333; margin-bottom: 5px;">Subject:</label>
      <input type="text" id="subject" name="subject" required style="width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;">

      <!-- Message
        Body
      -->
      <label for="body" style="display: block; font-size: 14px; color: #333; margin-bottom: 5px;">Message:</label>
      <textarea id="body" name="message" required rows="8" style="width: 100%; padding: 10px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;"></textarea>

      <!-- Submit Button -->
      <button type="submit" style="width: 100%; padding: 10px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer;"> Send Email </button>
    </form>

      <div id="email-popupOverlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.5); z-index: 1;">
        <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; padding: 20px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 2; border-radius: 5px; text-align: center;">
          <h2>Email Sent</h2>
          <button class="close-button" onclick="closePopup()" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Close</button>
        </div>
      </div>

      <script>
        async function handleEmailSend(formId) {
          const form = document.getElementById(formId);

          form.addEventListener("submit", async function(event) {
            event.preventDefault();

            const input = new FormData(event.target);
            const queryParams = new URLSearchParams(input).toString();
            const url = `${event.target.action}?${queryParams}`;

            try {
              const API_response = await fetch(url, {
                method: "GET"
              });

              if (API_response.status === 200) {
                showEmailPopup();
              }
            } catch (e) {
              console.log(e);
            }

          });
        }

        function showEmailPopup() {
          document.getElementById('email-popupOverlay').style.display = 'block';
        }

        function closePopup() {
          document.getElementById('email-popupOverlay').style.display = 'none';
          location.reload(); // Refresh the page
        }

        document.addEventListener("DOMContentLoaded", function() {
          handleEmailSend('send-Email');
        });
      </script>

  </div>




  <!-- footer section -->
  <section class="container-fluid footer_section">
    <p>
      &copy; ProfitPro LLC
    </p>
  </section>
  <!-- footer section -->
</div>


          <!--***************************-->
              <!--Search bar script-->
          <!--***************************-->


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchBar = document.getElementById('searchBar');
            const table = document.getElementById('accountsTable');
            const rows = table.getElementsByTagName('tr');
            const modal = document.getElementById('accountModal');
            const span = document.getElementsByClassName("close")[0];
            const accountDetails = document.getElementById('accountDetails');

            // Search functionality
            searchBar.addEventListener('keyup', function() {
                const searchTerm = searchBar.value.toLowerCase();

                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i];
                    const cells = row.getElementsByTagName('td');
                    let found = false;

                    for (let j = 0; j < cells.length; j++) {
                        const cellText = cells[j].textContent.toLowerCase();
                        if (cellText.includes(searchTerm)) {
                            found = true;
                            break;
                        }
                    }

                    row.style.display = found ? '' : 'none';
                }
            });
        });
    </script>


          <!--***************************-->
              <!--Search bar script for sprint 3-->
          <!--***************************-->

    <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Get the filter elements
      const statusFilter = document.getElementById('statusFilter');
      const searchInput = document.getElementById('searchInput');
      const dateFilter = document.getElementById('dateFilter');

      // Get the table body where journal entries will be displayed
      const journalTableBody = document.getElementById('journal-table');

      // Add event listeners to each filter
      statusFilter.addEventListener('change', filterJournalEntries);
      searchInput.addEventListener('input', filterJournalEntries);
      dateFilter.addEventListener('change', filterJournalEntries);

      function filterJournalEntries() {
        const statusValue = statusFilter.value.toLowerCase();
        const searchValue = searchInput.value.toLowerCase();
        const dateValue = dateFilter.value;

        // Get all rows from the table
        const rows = journalTableBody.getElementsByTagName('tr');

        for (let i = 0; i < rows.length; i++) {
          let row = rows[i];
          let showRow = true;

          // Filter by status
          const statusText = row.querySelector('td:nth-child(8)').textContent.toLowerCase();
          if (statusValue !== 'all' && statusText !== statusValue) {
            showRow = false;
          }

          // Filter by search input (searches across all <td> elements)
          if (searchValue) {
            const cells = row.getElementsByTagName('td');
            let found = false;

            // Loop through each cell in the row and check if it contains the search value
            for (let j = 0; j < cells.length; j++) {
              const cellText = cells[j].textContent.toLowerCase();
              if (cellText.includes(searchValue)) {
                found = true;
                break;
              }
            }

            if (!found) {
              showRow = false;
            }
          }

          // Filter by date (assumes the date format is YYYY-MM-DD in the table)
          const dateText = row.querySelector('td:nth-child(2)').textContent;
          if (dateValue && dateText !== dateValue) {
            showRow = false;
          }

          // Show or hide the row based on the filters
          row.style.display = showRow ? '' : 'none';
        }
      }
    });

    </script>













          <!--***************************-->
              <!--Calendar script-->
          <!--***************************-->
<script>

      let date = new Date();
      let year = date.getFullYear();
      let month = date.getMonth();

      const day = document.querySelector(".calendar-dates");

      const currdate = document
      .querySelector(".calendar-current-date");

      const prenexIcons = document
      .querySelectorAll(".calendar-navigation span");

      // Array of month names
      const months = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December"
      ];

      // Function to generate the calendar
      const manipulate = () => {

        // Get the first day of the month
        let dayone = new Date(year, month, 1).getDay();

        // Get the last date of the month
        let lastdate = new Date(year, month + 1, 0).getDate();

        // Get the day of the last date of the month
        let dayend = new Date(year, month, lastdate).getDay();

        // Get the last date of the previous month
        let monthlastdate = new Date(year, month, 0).getDate();

        // Variable to store the generated calendar HTML
        let lit = "";

        // Loop to add the last dates of the previous month
        for (let i = dayone; i > 0; i--) {
          lit +=
          `<li class="inactive">${monthlastdate - i + 1}</li>`;
        }

        // Loop to add the dates of the current month
        for (let i = 1; i <= lastdate; i++) {

          // Check if the current date is today
          let isToday = i === date.getDate()
            && month === new Date().getMonth()
            && year === new Date().getFullYear()
            ? "active"
            : "";
          lit += `<li class="${isToday}">${i}</li>`;
        }

        // Loop to add the first dates of the next month
        for (let i = dayend; i < 6; i++) {
          lit += `<li class="inactive">${i - dayend + 1}</li>`
        }

        // Update the text of the current date element 
        // with the formatted current month and year
        currdate.innerText = `${months[month]} ${year}`;

        // update the HTML of the dates element 
        // with the generated calendar
        day.innerHTML = lit;
      }

      manipulate();

      // Attach a click event listener to each icon
      prenexIcons.forEach(icon => {

        // When an icon is clicked
        icon.addEventListener("click", () => {

          // Check if the icon is "calendar-prev"
          // or "calendar-next"
          month = icon.id === "calendar-prev" ? month - 1 : month + 1;

          // Check if the month is out of range
          if (month < 0 || month > 11) {

            // Set the date to the first day of the 
            // month with the new year
            date = new Date(year, month, new Date().getDate());

            // Set the year to the new year
            year = date.getFullYear();

            // Set the month to the new month
            month = date.getMonth();
          }

          else {

            // Set the date to the current date
            date = new Date();
          }

          // Call the manipulate function to 
          // update the calendar display
          manipulate();
        });
      });
</script>




      <script>
        // Get elements
        const openButton = document.getElementById('openCalendar');
        const closeButton = document.getElementById('closeCalendar');

        document.addEventListener("DOMContentLoaded", function() {
          // Event Listener to open the calendar
          openButton.addEventListener('click', () => {

            overlay.style.display = 'block'; // Show overlay
            calendar.style.display = 'block'; // Show calendar
          });

          // Event Listener to close the calendar
          closeButton.addEventListener('click', () => {
            overlay.style.display = 'none'; // Hide overlay
            calendar.style.display = 'none'; // Hide calendar
          });

          // Close calendar when overlay is clicked
          overlay.addEventListener('click', () => {
            overlay.style.display = 'none'; // Hide overlay
            calendar.style.display = 'none'; // Hide calendar
          });
        });
    </script>






  <script type='module' src='main.js'></script>

  <script type="text/javascript" src="js-for-index/jquery-3.4.1.min.js"></script>
  <script type="text/javascript" src="js-for-index/bootstrap.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js">
  </script>

</body>

</html>
